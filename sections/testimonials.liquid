{% if section.settings.title != blank or section.blocks.size > 0 %}
  <section class="bg-[#F5F3FA] py-16">
    <div class="testimonials-wrapper">
      <div class="mx-auto max-w-[1600px]">
        {% if section.settings.title != blank %}
          <h2
            class="mb-12 text-left text-3xl font-bold"
            style="color: {{ section.settings.title_color | default: '#111827' }};"
          >
            {{ section.settings.title }}
          </h2>
        {% endif %}

        {% if section.blocks.size > 0 %}
          <div
            class="testimonials"
            data-delay="{{ section.settings.autoplay_delay | default: 50 }}"
            data-navigation="{{ section.settings.show_navigation | default: true }}"
            data-start-index="0"
          >
            <div class="testimonials__navigation">
              <div class="testimonials__viewport">
                <div class="testimonials__container">
                  {% for block in section.blocks %}
                    <div class="testimonials__slide" {{ block.shopify_attributes }}>
                      <div class="testimonial">
                        {% if block.settings.testimonial_text != blank %}
                          <blockquote>
                            <p style="color: {{ section.settings.testimonial_text_color | default: '#374151' }};">
                              "{{ block.settings.testimonial_text }}"
                            </p>
                          </blockquote>
                        {% endif %}

                        <div class="testimonial__author">
                          {% if block.settings.author_image != blank %}
                            <div class="author__image">
                              {{
                                block.settings.author_image
                                | image_url: width: 60
                                | image_tag: alt: block.settings.author_name
                              }}
                            </div>
                          {% endif %}

                          {% if block.settings.author_name != blank %}
                            <cite class="author__name">{{ block.settings.author_name }}</cite>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>

          {% if section.settings.show_navigation %}
            <div class="testimonials__buttons">
              <button class="button secondary testimonials__button testimonials__button--prev" type="button">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>
              <button class="button secondary testimonials__button testimonials__button--next" type="button">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
            </div>
          {% endif %}
        {% endif %}
      </div>
    </div>
  </section>
{% endif %}

{% schema %}
{
  "name": "Testimonials",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "What Our Customers Say"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "testimonial_text_color",
      "label": "Testimonial Text Color",
      "default": "#374151"
    },
    {
      "type": "range",
      "id": "autoplay_delay",
      "min": 30,
      "max": 100,
      "step": 10,
      "unit": "s",
      "label": "Autoplay Delay (3-10 seconds)",
      "default": 50,
      "info": "Controls the autoplay timing: 30=3s, 40=4s, 50=5s, 60=6s, 70=7s, 80=8s, 90=9s, 100=10s"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "testimonial_text",
          "label": "Text"
        },
        {
          "type": "text",
          "id": "author_name",
          "label": "Name"
        },
        {
          "type": "image_picker",
          "id": "author_image",
          "label": "Photo"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "testimonial_text": "Amazing product! Exceeded all my expectations.",
            "author_name": "Sarah Johnson"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "testimonial_text": "Great quality and excellent service.",
            "author_name": "Mike Chen"
          }
        }
      ]
    }
  ]
}
{% endschema %}
